# chapter1.1:VLAN综述

## 引入背景
   
   VLAN(Virtual LAN)的引入主要是为了解决传统的交换局域网(switched LANs)在配置时存在的问题。  
1. 缺少流量隔离  
   虽然LAN的层次结构将分组流量限制在单个交换机内，但广播流量（broadcast traffic)仍需要穿过整个网络。在某个网络接口被关闭或者错误配置的情况下，可能带来*广播风暴(boradcast storm)*的问题。  
2. LAN负载不均衡    
   这一问题导致将导致部分交换机不能被充分利用。例如某个机构包含10个分组，每个分组包含10人，需要10个交换机，因此96端口的交换机就不能被充分利用。    
3. 用户管理不便  
   例如某机构中的一个用户从一个分组调往另一个分组，或者一个用户属于两个分组，则都需要重新进行物理布线。  

## VLAN实现机制
    

在基于端口(port-based)的VLAN中,通过将交换机的端口（接口interface）划分为若干个部分，每一个部分组成一个VLAN，每个VLAN中的端口形成一个广播域。交换机仅在属于同一个VLAN的端口间转发帧。    

## 不同VLAN间通信
    
将交换机中的某个未声明端口连接一个外部路由器，然后配置该端口，使该端口属于待通信的多个VLAN。

## 不同交换机间同一VLAN通信
  
- 方式1：在不同交换机的同一个VLAN上各取一个端口，连接这对端口即可进行通信。  
<blockquote>该通信方式适用于VLAN个数较少的情况</blockquote>
- 方式2：VLAN trunking:在不同交换机上各取一个未声明端口作为trunk port,连接交换机上的trunk port即可通信。  
<blockquote>主流的同一VLAN通信方式，中继端口属于交换机上所有VLAN</blockquote>

## IEEE 802.1Q Standard
  
  在上述的VLAN trunking通信方式中,存在这样一个问题——交换机如何识别到达中继端口的帧属于哪个特定VLAN.为了解决这一问题，1998年，IEEE定义了一个新的扩展以太网帧格式(extended Ethernet frame format)802.1Q，其在初始的以太网帧格式中增加了<code>VLAN Tag</code>部分。交换机将在发送端的VLAN trunk将<code>VLAN Tag</code>加入帧，然后在接收端的VLAN trunk解析并移除<code>Vlan Tag</code>
    
  <code>VLAN Tag</code>包括两部分：*TPID*(Tag Protocal Identifier)和*TCI*(Tag Control Information).    

  - TPID  
  两个字节信息，为VLAN协议ID，其值为0x8100.
  - TCI  
  两个字节信息，分为三个子部分。其中低12位为VLAN标识符域，3位为优先级域，1位为规范格式指示器(Canonical format indicator).
   
